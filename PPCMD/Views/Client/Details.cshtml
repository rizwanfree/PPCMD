@model PPCMD.Models.Client

@{
    ViewData["Title"] = "Client Details";
}

<div class="container my-4">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <a asp-action="Index" class="text-success fw-medium text-decoration-none">
            ← Back to Clients
        </a>

        <div class="d-flex gap-2">
            <!-- Edit Button -->
            <a asp-action="Edit" asp-route-id="@Model.Id"
               class="btn btn-success shadow-sm">
                ✏️ Edit Client
            </a>

            <!-- Deactivate Button -->
            <button id="deactivateBtn" class="btn btn-danger shadow-sm">
                🛑 Deactivate
            </button>
        </div>
    </div>

    <!-- Metrics Cards -->
    <div class="row g-3 mb-4">
        <div class="col-md-3">
            <div class="card text-center shadow-sm">
                <div class="card-body">
                    <h6 class="text-muted small">Total Consignments</h6>
                    <p class="h4 text-success fw-bold">42</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center shadow-sm">
                <div class="card-body">
                    <h6 class="text-muted small">Pending Bills</h6>
                    <p class="h4 text-danger fw-bold">7</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center shadow-sm">
                <div class="card-body">
                    <h6 class="text-muted small">Receivables</h6>
                    <p class="h5 text-primary fw-bold">PKR 152,000</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center shadow-sm">
                <div class="card-body">
                    <h6 class="text-muted small">Credit Limit</h6>
                    <p class="h5 text-warning fw-bold">PKR 300,000</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Layout: Left column + Right column -->
    <div class="row g-4">
        <!-- Left Column (Client Info) -->
        <div class="col-md-3">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="text-success mb-3">Client Information</h5>
                    <dl class="row small">
                        <dt class="col-5 fw-medium">Client Name</dt>
                        <dd class="col-7">@Model.ClientName</dd>

                        <dt class="col-5 fw-medium">Contact Person</dt>
                        <dd class="col-7">@Model.ContactPerson</dd>

                        <dt class="col-5 fw-medium">Phone</dt>
                        <dd class="col-7">@Model.Phone</dd>

                        <dt class="col-5 fw-medium">Mobile</dt>
                        <dd class="col-7">@Model.Mobile</dd>

                        <dt class="col-5 fw-medium">Emails</dt>
                        <dd class="col-7">
                            @foreach (var email in Model.Emails)
                            {
                                <div>@email.Email</div>
                            }
                        </dd>

                        <dt class="col-5 fw-medium">Address</dt>
                        <dd class="col-7">@Model.Address</dd>

                        <dt class="col-5 fw-medium">Client Type</dt>
                        <dd class="col-7">@Model.ClientType?.Name</dd>
                    </dl>
                </div>
            </div>
        </div>

        <!-- Right Column (Tabs) -->
        <div class="col-md-9">
            <div class="card shadow-sm">
                <div class="card-body">
                    <!-- Bootstrap Nav Tabs -->
                    <ul class="nav nav-tabs mb-3" id="clientTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="jobs-tab" data-bs-toggle="tab" data-bs-target="#jobs"
                                    type="button" role="tab">
                                Jobs
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="self-tab" data-bs-toggle="tab" data-bs-target="#self"
                                    type="button" role="tab">
                                Self
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="bills-tab" data-bs-toggle="tab" data-bs-target="#bills"
                                    type="button" role="tab">
                                Bills
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="payments-tab" data-bs-toggle="tab" data-bs-target="#payments"
                                    type="button" role="tab">
                                Payments
                            </button>
                        </li>
                    </ul>

                    <!-- Tab Contents -->
                    <div class="tab-content">
                        <div class="tab-pane fade show active bg-light p-3 rounded" id="jobs" role="tabpanel">
                            Jobs data will appear here.
                        </div>
                        <div class="tab-pane fade bg-light p-3 rounded" id="self" role="tabpanel">
                            Self data will appear here.
                        </div>
                        <div class="tab-pane fade bg-light p-3 rounded" id="bills" role="tabpanel">
                            Bills data will appear here.
                        </div>
                        <div class="tab-pane fade bg-light p-3 rounded" id="payments" role="tabpanel">
                            Payments data will appear here.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap Modal -->
<div class="modal fade" id="deactivateModal" tabindex="-1" aria-labelledby="deactivateLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header border-0">
                <h5 class="modal-title text-danger">Confirm Deactivation</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to deactivate this client? This action can be reverted later.
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <form asp-action="Delete" asp-route-id="@Model.Id" method="post">
                    <button type="submit" class="btn btn-danger">Deactivate</button>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        const deactivateBtn = document.getElementById('deactivateBtn');
        deactivateBtn.addEventListener('click', () => {
            const modal = new bootstrap.Modal(document.getElementById('deactivateModal'));
            modal.show();
        });
    </script>
}
